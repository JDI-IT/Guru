<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Birthday Carousel (Vertical - Compact)</title>
  <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css"/>

  <style>
    :root{
      --page-bg:#ffffff;     /* page */
      --card-bg:#0f1116;     /* dark cards */
      --card-border:#7f8596;
      --text:#222;           /* default page text */
      --accent:#000;         /* title & dots */
    }

    html,body{
      margin:0;
      background:var(--page-bg);
      color:var(--text);
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* ===== Width of the carousel section =====
       Pick ONE of the two blocks below.
       A) ~25% LESS than 800px -> 600px
       B) Your example (800 -> 200px) i.e., very narrow
    */

    /* A) 25% less (800 -> 600) */
    .wrap { max-width: 600px; margin: 16px auto; padding: 0 12px; text-align: center; }

    /* B) 800 -> 200px (uncomment this and comment A if you want it this narrow) */
    /* .wrap { max-width: 200px; margin: 16px auto; padding: 0 8px; text-align: center; } */

    .carousel-title{
      font-size:18px; font-weight:700; color:var(--accent);
      margin:0 0 6px; line-height:1.3;
    }
    .carousel-title span{
      display:block; font-size:14px; color:#555; font-weight:400;
      margin-bottom:8px;
    }

    /* ===== Swiper container =====
       Let it auto-size to the active slide (no fixed height). */
    .swiper{
      width:100%;
      height:auto;              /* key: let Swiper size itself */
      padding:0 0 18px 0;       /* room for dots */
      position:relative;
    }

    /* ===== Slides: hug content ===== */
    .swiper-slide{
      background:var(--card-bg);
      color:#fff !important;
      border:1px solid rgba(127,133,150,.5);
      border-radius:12px;
      box-shadow:0 6px 18px rgba(0,0,0,.25);
      display:flex; align-items:center; justify-content:center; text-align:center;
      padding:10px 14px;        /* tighter padding for compact height */
      line-height:1.35;
      font-size:16px;
      height:auto;              /* key: allow natural height */
    }

    .msg{
      max-width: 100%;
      white-space: pre-wrap;
      color:#fff !important;
    }

    /* Hide arrows for compact layout (dots + autoplay is cleaner) */
    .swiper-button-prev, .swiper-button-next{ display:none; }

    /* Dots */
    .swiper-pagination { position:relative; bottom:0 !important; margin-top:10px; }
    .swiper-pagination-bullet{ background:var(--accent); opacity:.45; }
    .swiper-pagination-bullet-active{ opacity:1; }

    @media (max-width:480px){
      .carousel-title{ font-size:16px; }
      .carousel-title span{ font-size:13px; }
      .swiper-slide{ font-size:15px; padding:8px 12px; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <h1 class="carousel-title">
      üéâ Happiest Birthday to this month‚Äôs celebrants! üéÇ
      <span>Wishing you all a wonderful year ahead!</span>
    </h1>

    <div class="swiper">
      <div class="swiper-wrapper" id="slides"></div>
      <div class="swiper-pagination"></div>
    </div>
  </div>

  <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
  <script>
    const cacheBuster = 'ts=' + Date.now();

    fetch('messages.json?' + cacheBuster, { cache:'no-store' })
      .then(r => { if(!r.ok) throw new Error('messages.json not found'); return r.json(); })
      .then(messages => {
        const wrapper = document.getElementById('slides');
        messages.forEach(text => {
          const slide = document.createElement('div');
          slide.className = 'swiper-slide';
          const safeText = escapeHtml(text).replaceAll('\\n','<br>');
          slide.innerHTML = `<div class="msg">${safeText}</div>`;
          wrapper.appendChild(slide);
        });

        new Swiper('.swiper', {
          direction: 'vertical',
          slidesPerView: 1,
          spaceBetween: 10,
          loop: true,
          autoplay: { delay: 3000, disableOnInteraction: false },
          mousewheel: true,
          autoHeight: true,                  // üîë slide height matches content
          pagination: { el: '.swiper-pagination', clickable: true }
        });
      })
      .catch(err=>{
        console.error(err);
        const wrapper = document.getElementById('slides');
        const slide = document.createElement('div');
        slide.className = 'swiper-slide';
        slide.textContent = '‚ö†Ô∏è Could not load messages.json';
        wrapper.appendChild(slide);
      });

    function escapeHtml(str){
      return String(str)
        .replaceAll('&','&amp;')
        .replaceAll('<','&lt;')
        .replaceAll('>','&gt;')
        .replaceAll('"','&quot;')
        .replaceAll("'",'&#39;');
    }
  </script>
</body>
</html>
